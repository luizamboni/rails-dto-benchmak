# V1 vs V2 Performance Report

## Summary

Heavy comparison of v1 and v2 registration endpoints using `wrk` with per-container
Docker memory sampling.

## Test Setup

- Date: 2026-01-29 09:29:24
- Tool: `wrk`
- Duration: 120s per endpoint
- Threads: 12
- Connections: 400
- Method: POST
- Payload:
  - `{"user":{"email":"perf@example.com","password":"password","password_confirmation":"password"}}`
- Headers:
  - `Content-Type: application/json`
- v1 Base URL: `http://localhost:3001`
- v2 Base URL: `http://localhost:3002`
- v1 Path: `/api/v1/register`
- v2 Path: `/api/v2/register`
- Docker container v1: `registration_api-web_v1-1`
- Docker container v2: `registration_api-web_v2-1`
- Memory sampling: `docker stats` every 0.5s (avg/max RSS)

## Results

| Endpoint | Req/s | Latency | Memory Avg (MB) | Memory Max (MB) | Samples |
|---|---:|---:|---:|---:|---:|
| v1 | 11.25 | 1.15s | 108.19 | 112.40 | 59 |
| v2 | 11.60 | 1.12s | 120.21 | 124.30 | 59 |

### Delta (v2 - v1)

- Throughput: +0.35 req/s
- Latency: -0.03s
- Memory: +12.02 MB avg, +11.90 MB max

## Analysis

- Throughput is effectively tied at this load; the +0.35 req/s difference is within typical run-to-run noise.
- Latency is also effectively tied (1.12s vs 1.15s), so responsiveness is comparable.
- v2 consistently uses more memory during the run (about +12 MB avg/max).
- If this memory delta matters, repeat runs or a small load matrix would confirm whether it scales with higher concurrency.
